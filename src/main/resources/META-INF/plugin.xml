<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin xmlns:xi="http://www.w3.org/2001/XInclude">
    <!-- Unique identifier of the plugin. It should be FQN. It cannot be changed between the plugin versions. -->
    <id>intellij-ocaml</id>

    <!-- Public plugin name should be written in Title Case.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-name -->
    <name>OCaml</name>

    <!-- A displayed Vendor name or Organization ID displayed on the Plugins Page. -->
    <vendor email="ramsamy.ws@gmail.com" url="https://github.com/QuentinRa/">QuentinRa</vendor>

    <!-- Description of the plugin displayed on the Plugin Page and IDE Plugin Manager.
         Simple HTML elements (text formatting, paragraphs, and lists) can be added inside of <![CDATA[ ]]> tag.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-description -->
    <description><![CDATA[
        The OCaml plugin is providing support for the OCaml language in all IDEs (IntelliJ, CLion, ...),
        using opam or native SDKs. Based on ReasonML.]]>
    </description>

    <!-- Product and plugin compatibility requirements.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-compatibility.html -->
    <depends>com.intellij.modules.platform</depends>
    <depends optional="true" config-file="deps/java-deps.xml">com.intellij.modules.java</depends>

    <actions>
        <!-- Add your actions here -->
        <!-- Create file -->
        <action id="NewOCamlFile" class="com.ocaml.ide.files.actions.OCamlCreateFileAction">
            <add-to-group group-id="NewGroup" anchor="before" relative-to-action="NewFile"/>
        </action>
    </actions>

    <!-- Extension points defined by the plugin.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-extension-points.html -->
    <extensions defaultExtensionNs="com.intellij">
        <!-- FILES -->
        <fileType extensions="ml" hashBangs="ml" name="OCaml File" language="OCaml"
                  fieldName="INSTANCE" implementationClass="com.ocaml.ide.files.OCamlFileType"/>
        <fileType extensions="mli" hashBangs="mli" name="OCaml Interface File" language="OCamli"
                  fieldName="INSTANCE" implementationClass="com.ocaml.ide.files.OCamlInterfaceFileType"/>
        <internalFileTemplate name="OCaml File"/>
        <internalFileTemplate name="OCaml Interface"/>

        <!-- PARSER -->
        <lang.parserDefinition language="OCaml" implementationClass="com.ocaml.language.parser.OCamlParserDefinition"/>
        <lang.parserDefinition language="OCamli" implementationClass="com.ocaml.language.parser.OCamlInterfaceParserDefinition"/>
        <stubElementTypeHolder class="com.ocaml.language.psi.OCamlTypes" externalIdPrefix="ocaml."/>

        <!-- INDICES -->
        <stubIndex implementation="com.ocaml.language.psi.stubs.index.OCamlVariablesIndex"/>
        <stubIndex implementation="com.ocaml.language.psi.stubs.index.OCamlTypesIndex"/>

        <!-- HIGHLIGHT -->
        <lang.syntaxHighlighterFactory language="OCaml" implementationClass="com.ocaml.ide.highlight.OCamlSyntaxHighlighterFactory"/>
        <colorSettingsPage implementation="com.ocaml.ide.settings.OCamlColorSettingsPage"/>
        <highlightErrorFilter implementation="com.ocaml.ide.highlight.OCamlSyntaxErrorFilter" />

        <!-- ANNOTATOR -->
        <annotator language="OCaml" implementationClass="com.ocaml.ide.annotator.OCamlHighlightingAnnotator"/>
        <annotator language="OCaml" implementationClass="com.odoc.ide.annotator.OdocDocumentationAnnotator"/>
        <lang.elementManipulator forClass="com.ocaml.language.psi.mixin.OCamlValuePathBindingMixin"
                                 implementationClass="com.ocaml.language.psi.mixin.OCamlValuePathManipulator" />

        <!-- INSIGHT -->
<!--        <codeInsight.lineMarkerProvider language="OCaml" implementationClass="com.ocaml.ide.navigation.OCamlLineMarkerProvider"/>-->
<!--        <annotator language="OCaml" implementationClass="com.ocaml.ide.insight.OCamlSyntaxAnnotator"/>-->

        <!-- STRUCTURE VIEW -->
        <lang.psiStructureViewFactory language="OCaml" implementationClass="com.ocaml.ide.structure.OCamlStructureViewFactory"/>

        <!-- NAVIGATION -->
        <codeInsight.lineMarkerProvider language="OCaml" implementationClass="com.ocaml.ide.lineMarkers.OCamlLineMarkerProvider"/>

        <!-- COMMENTS / DOC -->
        <lang.commenter language="OCaml" implementationClass="com.ocaml.ide.commenter.OCamlCommenter"/>
        <lang.documentationProvider language="OCaml" implementationClass="com.ocaml.ide.commenter.OCamlDocumentationProvider"/>
        <lang.documentationProvider language="OCamli" implementationClass="com.ocaml.ide.commenter.OCamlDocumentationProvider"/>

        <!-- TYPING -->
        <lang.braceMatcher language="OCaml" implementationClass="com.ocaml.ide.typing.OCamlBraceMatcher"/>

        <!-- TEMPLATES -->
        <defaultLiveTemplates file="liveTemplates/default"/>
        <liveTemplateContext contextId="OCAML_FILE" implementation="com.ocaml.ide.template.OCamlContextType$Generic"/>

        <!-- SPELL-CHECKER -->
        <spellchecker.support language="OCaml" implementationClass="com.ocaml.ide.spelling.OCamlSpellcheckingStrategy"/>

        <!-- MODULES -->
        <moduleBuilder builderClass="com.ocaml.ide.module.OCamlModuleBuilder" order="first"/>
        <moduleType id="OCAML_MODULE" implementationClass="com.ocaml.ide.module.OCamlIdeaModuleType" classpathProvider="true"/>
<!--        <directoryProjectGenerator implementation="com.ocaml.ide.wizard.minor.OCamlDirectoryProjectGenerator"/>-->

        <!-- SDK -->
        <sdkType implementation="com.ocaml.sdk.OCamlSdkType"/>
        <sdkDownload implementation="com.ocaml.sdk.OCamlSdkType"/>
        <projectViewNodeDecorator implementation="com.ocaml.sdk.nodes.OCamlLibraryRootsNodeDecorator"/>
        <treeStructureProvider implementation="com.ocaml.sdk.nodes.OCamlLibraryRootsTreeStructureProvider"/>
        <projectSdkSetupValidator implementation="com.ocaml.sdk.validator.OCamlSDKValidator"/>

        <!-- BUILD/RUN -->
        <configurationType implementation="com.ocaml.sdk.runConfiguration.OCamlRunConfigurationType"/>
    </extensions>

    <xi:include href="/META-INF/dune.xml" xpointer="xpointer(/idea-plugin/*)"/>
</idea-plugin>